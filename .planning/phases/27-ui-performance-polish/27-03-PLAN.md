---
phase: 27-ui-performance-polish
plan: 03
type: execute
wave: 2
depends_on: [27-01]
files_modified:
  - modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php
  - modules/AppVideoWizard/app/Livewire/VideoWizard.php
autonomous: true

must_haves:
  truths:
    - "Hollywood expansion toggle visible in storyboard settings sidebar"
    - "Toggle state persists and affects prompt generation"
    - "When disabled, prompts skip LLM expansion entirely"
  artifacts:
    - path: "modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php"
      provides: "Settings toggle UI in sidebar"
      contains: "hollywood_expansion"
    - path: "modules/AppVideoWizard/app/Livewire/VideoWizard.php"
      provides: "Toggle handler and state sync"
      contains: "toggleHollywoodExpansion"
  key_links:
    - from: "storyboard.blade.php toggle"
      to: "VideoWizard::toggleHollywoodExpansion"
      via: "wire:click"
      pattern: "wire:click.*toggleHollywoodExpansion"
    - from: "VideoWizard.php"
      to: "VwSetting::setValue"
      via: "Toggle persistence"
      pattern: "VwSetting::setValue.*hollywood_expansion"
---

<objective>
Add Hollywood expansion toggle to storyboard settings sidebar

Purpose: Let users enable/disable AI-enhanced prompts for faster generation or quality tradeoff
Output: Toggle in settings sidebar that controls VwSetting value
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/27-ui-performance-polish/27-CONTEXT.md
@.planning/phases/27-ui-performance-polish/27-01-PLAN.md
@modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php
@modules/AppVideoWizard/app/Livewire/VideoWizard.php
@modules/AppVideoWizard/app/Models/VwSetting.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add toggle handler to VideoWizard.php</name>
  <files>modules/AppVideoWizard/app/Livewire/VideoWizard.php</files>
  <action>
1. Add property for the toggle state. Find the properties section (near other public properties) and add:
```php
/**
 * Hollywood prompt expansion toggle state.
 * When true, complex shots route through LLM for AI-enhanced prompts.
 */
public bool $hollywoodExpansionEnabled = true;
```

2. Add method to load the setting value. Find the `mount()` method and add near the end:
```php
// Load Hollywood expansion setting
$this->hollywoodExpansionEnabled = VwSetting::getValue('hollywood_expansion_enabled', true);
```

3. Add the toggle method. Find a good location near other toggle methods (like toggleMultiShotMode) and add:
```php
/**
 * Toggle Hollywood prompt expansion setting.
 * When disabled, all shots use template-only prompts (faster but less detailed).
 */
public function toggleHollywoodExpansion(): void
{
    $this->hollywoodExpansionEnabled = !$this->hollywoodExpansionEnabled;

    // Persist to database
    VwSetting::setValue('hollywood_expansion_enabled', $this->hollywoodExpansionEnabled ? 'true' : 'false');

    // Clear cache to ensure new setting takes effect
    VwSetting::clearCache();

    $this->dispatch('notify', [
        'type' => 'success',
        'message' => $this->hollywoodExpansionEnabled
            ? __('Hollywood expansion enabled - AI-enhanced prompts for complex shots')
            : __('Hollywood expansion disabled - using template prompts for faster generation'),
    ]);
}
```

4. Ensure VwSetting is imported at the top of the file:
```php
use Modules\AppVideoWizard\Models\VwSetting;
```
  </action>
  <verify>
- Property `$hollywoodExpansionEnabled` exists in VideoWizard.php
- mount() loads the setting value
- toggleHollywoodExpansion() method exists
- Method toggles state and persists to VwSetting
- VwSetting import present
  </verify>
  <done>
- Toggle state property added
- State loaded from database on mount
- Toggle method persists change to database
- User notification shown on toggle
  </done>
</task>

<task type="auto">
  <name>Task 2: Add toggle UI to storyboard settings sidebar</name>
  <files>modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php</files>
  <action>
Find the settings sidebar section in storyboard.blade.php. Look for the "Production" or "Settings" section (around line 4800, near the Multi-Shot Mode toggle).

Add the Hollywood expansion toggle in the same section, either before or after Multi-Shot Mode. Find this pattern:
```blade
<div class="vw-sidebar-section open">
    <div class="vw-sidebar-section-body" style="padding-top: 0.5rem;">
        <div class="vw-sidebar-toggle">
            <span class="vw-sidebar-toggle-label">
                <span>ðŸŽ¬</span>
                {{ __('Multi-Shot Mode') }}
```

Add BEFORE it (so Hollywood expansion appears first in the section):
```blade
{{-- Hollywood Expansion Toggle --}}
<div class="vw-sidebar-toggle" style="margin-bottom: 0.75rem;">
    <span class="vw-sidebar-toggle-label">
        <span>âœ¨</span>
        {{ __('Hollywood Expansion') }}
        <span class="vw-badge vw-badge-new" style="font-size: 0.5rem; padding: 0.1rem 0.3rem;">AI</span>
    </span>
    <div class="vw-sidebar-toggle-switch {{ $hollywoodExpansionEnabled ? 'active' : '' }}"
         wire:click="toggleHollywoodExpansion"
         title="{{ $hollywoodExpansionEnabled ? __('Click to disable AI-enhanced prompts') : __('Click to enable AI-enhanced prompts') }}">
        <div class="vw-sidebar-toggle-track"></div>
        <div class="vw-sidebar-toggle-thumb"></div>
    </div>
</div>
<p style="font-size: 0.65rem; color: rgba(255,255,255,0.4); margin-bottom: 0.75rem; line-height: 1.4;">
    {{ $hollywoodExpansionEnabled
        ? __('Complex shots get AI-enhanced Hollywood-quality prompts')
        : __('All shots use fast template-only prompts')
    }}
</p>
```

The toggle should use the existing CSS classes (vw-sidebar-toggle, vw-sidebar-toggle-switch, etc.) that are already defined for Multi-Shot Mode.
  </action>
  <verify>
- Hollywood expansion toggle visible in storyboard sidebar
- Toggle uses $hollywoodExpansionEnabled state
- wire:click calls toggleHollywoodExpansion
- Helper text shows current mode description
- Toggle styled consistently with Multi-Shot Mode toggle
  </verify>
  <done>
- Toggle appears in settings sidebar
- Shows AI badge
- Click toggles state via wire:click
- Helper text updates based on state
- Consistent styling with existing toggles
  </done>
</task>

</tasks>

<verification>
1. Load storyboard step in browser
2. Open settings sidebar
3. Hollywood expansion toggle visible with AI badge
4. Click toggle - notification appears
5. Reload page - toggle state persists
6. When disabled, prompts should be faster (template-only)
</verification>

<success_criteria>
- Toggle visible in storyboard settings sidebar
- Label: "Hollywood Expansion" with AI badge
- Toggle state persists across page reloads
- Helper text describes current mode
- Notification shown on toggle
- State synced with VwSetting database
</success_criteria>

<output>
After completion, create `.planning/phases/27-ui-performance-polish/27-03-SUMMARY.md`
</output>
