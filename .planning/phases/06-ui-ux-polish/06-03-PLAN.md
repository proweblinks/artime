---
phase: 06-ui-ux-polish
plan: 03
type: execute
wave: 2
depends_on: ["06-01", "06-02"]
files_modified:
  - modules/AppVideoWizard/resources/views/livewire/modals/multi-shot.blade.php
  - modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Per-shot status badges show pending/generating/complete"
    - "Emotional intensity bar visible on shots"
    - "Progress summary shows detailed breakdown"
    - "Status colors are consistent"
  artifacts:
    - path: "modules/AppVideoWizard/resources/views/livewire/modals/multi-shot.blade.php"
      provides: "Per-shot status and intensity indicators"
      contains: "vw-status-badge"
  key_links:
    - from: "multi-shot.blade.php"
      to: "shot status"
      via: "status badges and intensity bars"
      pattern: "imageStatus"
---

<objective>
Add enhanced progress indicators with per-shot status and intensity visualization.

**PROBLEM:** Progress feedback lacks granularity:
- No per-shot status on cards
- No intensity visualization
- Hard to see which shots are pending/complete
- No visual arc representation

Purpose: Provide detailed progress feedback at shot level with intensity indicators.

Output: Per-shot status badges, intensity bars, and enhanced progress summary.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@modules/AppVideoWizard/resources/views/livewire/modals/multi-shot.blade.php
@modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add status badge CSS</name>
  <files>modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php</files>
  <action>
Add CSS for status badges and intensity bars in the style section:

```css
/* PHASE 6: Status Badges */
.vw-status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.2rem;
    padding: 0.15rem 0.35rem;
    border-radius: 0.2rem;
    font-size: 0.55rem;
    font-weight: 600;
    text-transform: uppercase;
}

.vw-status-pending {
    background: rgba(168, 162, 158, 0.2);
    color: rgba(168, 162, 158, 0.9);
}

.vw-status-generating {
    background: rgba(245, 158, 11, 0.2);
    color: rgba(245, 158, 11, 0.95);
    animation: pulse 1.5s ease-in-out infinite;
}

.vw-status-complete {
    background: rgba(34, 197, 94, 0.2);
    color: rgba(34, 197, 94, 0.95);
}

.vw-status-error {
    background: rgba(239, 68, 68, 0.2);
    color: rgba(239, 68, 68, 0.95);
}

/* Intensity Bar */
.vw-intensity-bar {
    height: 3px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 1.5px;
    overflow: hidden;
    margin: 0.25rem 0;
}

.vw-intensity-fill {
    height: 100%;
    border-radius: 1.5px;
    transition: width 0.3s ease;
}

.vw-intensity-low { background: rgba(59, 130, 246, 0.8); }
.vw-intensity-medium { background: rgba(245, 158, 11, 0.8); }
.vw-intensity-high { background: rgba(239, 68, 68, 0.8); }
.vw-intensity-climax {
    background: linear-gradient(90deg, rgba(139, 92, 246, 0.9), rgba(236, 72, 153, 0.9));
}

/* Mini Progress Ring */
.vw-mini-progress {
    width: 16px;
    height: 16px;
    position: relative;
}

.vw-mini-progress svg {
    transform: rotate(-90deg);
}

.vw-mini-progress-bg {
    fill: none;
    stroke: rgba(255, 255, 255, 0.1);
    stroke-width: 2;
}

.vw-mini-progress-fill {
    fill: none;
    stroke-width: 2;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
}
```

WHY: Consistent status styling across all shot displays.
  </action>
  <verify>
    - Status badge classes defined (pending, generating, complete, error)
    - Generating has pulse animation
    - Intensity bar with fill variations
    - Mini progress ring styles
    - No CSS syntax errors
  </verify>
  <done>Status badge CSS added</done>
</task>

<task type="auto">
  <name>Task 2: Add per-shot status badges to multi-shot modal</name>
  <files>modules/AppVideoWizard/resources/views/livewire/modals/multi-shot.blade.php</files>
  <action>
Find the shot card in multi-shot modal and add status badges:

```blade
{{-- PHASE 6: Shot Status and Intensity --}}
<div style="display: flex; align-items: center; gap: 0.35rem; margin-top: 0.25rem;">
    {{-- Image Status --}}
    @php
        $imgStatus = $shot['imageStatus'] ?? 'pending';
        $vidStatus = $shot['videoStatus'] ?? 'pending';
    @endphp

    <div class="vw-status-badge vw-status-{{ $imgStatus }}">
        @if($imgStatus === 'pending')
            <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24" fill="currentColor">
                <circle cx="12" cy="12" r="10"/>
            </svg>
        @elseif($imgStatus === 'generating')
            <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
            </svg>
        @elseif($imgStatus === 'ready')
            <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"/>
            </svg>
        @else
            <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
        @endif
        IMG
    </div>

    {{-- Video Status (if applicable) --}}
    @if(!empty($shot['needsLipSync']) || $vidStatus !== 'pending')
        <div class="vw-status-badge vw-status-{{ $vidStatus }}">
            @if($vidStatus === 'ready')
                <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
            @elseif($vidStatus === 'generating')
                <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                    <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83"/>
                </svg>
            @else
                <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24" fill="currentColor">
                    <circle cx="12" cy="12" r="10"/>
                </svg>
            @endif
            VID
        </div>
    @endif
</div>

{{-- Intensity Bar --}}
@php
    $intensity = $shot['emotionalIntensity'] ?? 0.5;
    $isClimax = $shot['isClimax'] ?? false;
    $intensityClass = $isClimax ? 'climax' : ($intensity >= 0.7 ? 'high' : ($intensity >= 0.4 ? 'medium' : 'low'));
    $intensityPercent = round($intensity * 100);
@endphp
<div class="vw-intensity-bar" title="Intensity: {{ $intensityPercent }}%">
    <div class="vw-intensity-fill vw-intensity-{{ $intensityClass }}" style="width: {{ $intensityPercent }}%;"></div>
</div>
```

WHY: Per-shot status enables quick identification of generation progress.
  </action>
  <verify>
    - Image status badge shows pending/generating/complete/error
    - Video status badge shows when applicable
    - Intensity bar displays with correct color
    - Climax shots have gradient intensity bar
    - No blade syntax errors
  </verify>
  <done>Per-shot status badges added to multi-shot modal</done>
</task>

<task type="auto">
  <name>Task 3: Add enhanced progress summary to multi-shot header</name>
  <files>modules/AppVideoWizard/resources/views/livewire/modals/multi-shot.blade.php</files>
  <action>
Find the multi-shot modal header and add detailed progress summary:

```blade
{{-- PHASE 6: Enhanced Progress Summary --}}
@php
    $shots = $multiShotMode['decomposedScenes'][$selectedSceneIndex]['shots'] ?? [];
    $totalShots = count($shots);
    $imagesReady = collect($shots)->where('imageStatus', 'ready')->count();
    $imagesGenerating = collect($shots)->where('imageStatus', 'generating')->count();
    $videosReady = collect($shots)->where('videoStatus', 'ready')->count();
    $videosNeeded = collect($shots)->where('needsLipSync', true)->count();
    $avgIntensity = $totalShots > 0 ? collect($shots)->avg('emotionalIntensity') ?? 0.5 : 0.5;
@endphp

<div style="
    display: flex;
    gap: 0.75rem;
    padding: 0.5rem 0.75rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 0.5rem;
    margin-bottom: 0.75rem;
    font-size: 0.7rem;
">
    {{-- Image Progress --}}
    <div style="display: flex; align-items: center; gap: 0.35rem;">
        <div class="vw-mini-progress">
            <svg width="16" height="16" viewBox="0 0 16 16">
                <circle class="vw-mini-progress-bg" cx="8" cy="8" r="6"/>
                <circle class="vw-mini-progress-fill" cx="8" cy="8" r="6"
                    stroke="{{ $imagesReady === $totalShots ? '#22C55E' : '#3B82F6' }}"
                    stroke-dasharray="{{ 2 * 3.14159 * 6 }}"
                    stroke-dashoffset="{{ 2 * 3.14159 * 6 * (1 - ($totalShots > 0 ? $imagesReady / $totalShots : 0)) }}"/>
            </svg>
        </div>
        <span style="color: rgba(255,255,255,0.7);">Images:</span>
        <span style="color: {{ $imagesReady === $totalShots ? '#22C55E' : '#fff' }}; font-weight: 600;">
            {{ $imagesReady }}/{{ $totalShots }}
        </span>
        @if($imagesGenerating > 0)
            <span class="vw-status-badge vw-status-generating" style="font-size: 0.5rem;">
                {{ $imagesGenerating }} generating
            </span>
        @endif
    </div>

    {{-- Video Progress (if lip-sync needed) --}}
    @if($videosNeeded > 0)
        <div style="display: flex; align-items: center; gap: 0.35rem;">
            <div class="vw-mini-progress">
                <svg width="16" height="16" viewBox="0 0 16 16">
                    <circle class="vw-mini-progress-bg" cx="8" cy="8" r="6"/>
                    <circle class="vw-mini-progress-fill" cx="8" cy="8" r="6"
                        stroke="{{ $videosReady === $videosNeeded ? '#22C55E' : '#06B6D4' }}"
                        stroke-dasharray="{{ 2 * 3.14159 * 6 }}"
                        stroke-dashoffset="{{ 2 * 3.14159 * 6 * (1 - ($videosNeeded > 0 ? $videosReady / $videosNeeded : 0)) }}"/>
                </svg>
            </div>
            <span style="color: rgba(255,255,255,0.7);">Videos:</span>
            <span style="color: {{ $videosReady === $videosNeeded ? '#22C55E' : '#fff' }}; font-weight: 600;">
                {{ $videosReady }}/{{ $videosNeeded }}
            </span>
        </div>
    @endif

    {{-- Average Intensity --}}
    <div style="display: flex; align-items: center; gap: 0.35rem; margin-left: auto;">
        <span style="color: rgba(255,255,255,0.5);">Avg Intensity:</span>
        <span style="color: {{ $avgIntensity >= 0.7 ? '#EF4444' : ($avgIntensity >= 0.4 ? '#F59E0B' : '#3B82F6') }}; font-weight: 600;">
            {{ round($avgIntensity * 100) }}%
        </span>
    </div>
</div>
```

WHY: Progress summary provides at-a-glance generation status.
  </action>
  <verify>
    - Image progress shows X/Y with mini progress ring
    - Video progress shows when lip-sync needed
    - Generating count shown when active
    - Average intensity displayed
    - Colors indicate completion state
    - No blade syntax errors
  </verify>
  <done>Enhanced progress summary added to multi-shot header</done>
</task>

<task type="auto">
  <name>Task 4: Add intensity indicator to main scene cards</name>
  <files>modules/AppVideoWizard/resources/views/livewire/steps/storyboard.blade.php</files>
  <action>
Add a small intensity indicator to main scene cards when multi-shot data exists:

```blade
{{-- PHASE 6: Scene Intensity Indicator --}}
@if($multiShotMode && !empty($multiShotMode['decomposedScenes'][$index]['shots']))
    @php
        $sceneShots = $multiShotMode['decomposedScenes'][$index]['shots'];
        $avgIntensity = collect($sceneShots)->avg('emotionalIntensity') ?? 0.5;
        $hasClimax = collect($sceneShots)->contains('isClimax', true);
        $intensityClass = $hasClimax ? 'climax' : ($avgIntensity >= 0.7 ? 'high' : ($avgIntensity >= 0.4 ? 'medium' : 'low'));
    @endphp

    <div style="
        display: flex;
        align-items: center;
        gap: 0.35rem;
        margin-top: 0.35rem;
    ">
        <div class="vw-intensity-bar" style="flex: 1;" title="Scene Intensity: {{ round($avgIntensity * 100) }}%">
            <div class="vw-intensity-fill vw-intensity-{{ $intensityClass }}" style="width: {{ round($avgIntensity * 100) }}%;"></div>
        </div>

        @if($hasClimax)
            <span class="vw-shot-badge vw-shot-badge-climax" style="font-size: 0.5rem;">
                CLIMAX
            </span>
        @endif

        <span style="font-size: 0.55rem; color: rgba(255,255,255,0.5);">
            {{ round($avgIntensity * 100) }}%
        </span>
    </div>
@endif
```

WHY: Scene-level intensity shows emotional arc at storyboard level.
  </action>
  <verify>
    - Intensity bar appears on decomposed scene cards
    - Color indicates intensity level
    - Climax badge shows if scene contains climax
    - Percentage displayed
    - No blade syntax errors
  </verify>
  <done>Intensity indicator added to main scene cards</done>
</task>

</tasks>

<verification>
1. Check multi-shot modal shows per-shot status badges
2. Check intensity bars display with correct colors
3. Check progress summary shows accurate counts
4. Check scene cards show intensity indicator
5. No PHP/Blade/CSS errors
</verification>

<success_criteria>
- Per-shot status badges (pending/generating/complete/error)
- Intensity bars with color gradient
- Progress summary with mini rings
- Climax indicator on climax scenes
- Generating animation on active items
- No syntax errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-ui-ux-polish/06-03-SUMMARY.md`
</output>
